import socket

def grab_banner(target, port):
    print(f"[*] Attempting to grab banner from {target}:{port}...")
    try:
        # Create a socket object
        s = socket.socket()
        # Set a timeout so we don't hang if the service is silent
        s.settimeout(2)
        s.connect((target, port))
        
        # Most services send a banner immediately upon connection.
        # We receive up to 1024 bytes of data.
        banner = s.recv(1024)
        
        if banner:
            # Decode the bytes to a string and strip whitespace
            banner_text = banner.decode().strip()
            print(f"[+] Banner Found: {banner_text}")
            return banner_text
        else:
            print("[-] Connection successful, but no banner was sent.")
            return None
            
    except socket.timeout:
        print("[!] Connection timed out. The service might be silent.")
    except Exception as e:
        print(f"[!] Could not grab banner: {e}")
    finally:
        s.close()

    return None