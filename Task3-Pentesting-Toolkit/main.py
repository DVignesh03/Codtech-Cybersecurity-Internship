from modules.port_scanner import scan_ports
from modules.banner_grabber import grab_banner
from modules.brute_forcer import ssh_brute_force

def main_menu():
    print("\n=== MODULAR PENTESTING TOOLKIT ===")
    print("1. Network Port Scanner")
    print("2. Subdomain Finder (Recon)")
    print("3. Service Banner Grabber")
    print("4. SSH Brute-Forcer")
    print("0. Exit")
    
    choice = input("Select an option: ")
    
    if choice == '1':
        target = input("Enter target IP/Hostname: ")
        # Common ports to scan: 21, 22, 80, 443, 3306
        port_list = [21, 22, 23, 25, 53, 80, 110, 443, 3306, 3389]
        scan_ports(target, port_list)
    
    elif choice == '2':
        domain = input("Enter target IP/Hostname: ")
        port = input("Enter port number to probe (e.g., 80, 22, 21): ")
        scan_ports(domain, port)
    
    elif choice == '3':
        target = input("Enter target IP/Hostname: ")
        port = int(input("Enter port number to probe (e.g., 80, 22, 21): "))
        grab_banner(target, port)

    elif choice == '4':
        target = input("Enter target IP/Hostname: ")
        user = input("Enter username to target: ")
        # In a real scenario, you'd load these from a file
        passwords = ["123456", "password", "admin", "admin123", "qwerty"]
        ssh_brute_force(target, user, passwords)

    elif choice == '0':
        exit()
    
    else:
        print("[!] Invalid choice.")

if __name__ == "__main__":
    while True:
        main_menu()